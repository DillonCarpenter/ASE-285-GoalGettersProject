<html lang="en">
    <head>
        <title>Sign in</title>
        <link rel="stylesheet" href="styles/global.css" />
    </head>
    <body>
        <h3>Sign In</h3>
        <form id="loginForm">
            <input type="text" id="username" required /><br>
            <input type="password" id="password" required/><br>
            <button type="submit">Sign in</button> 
        </form>
        <p>Don't have an account? <a href="/signup">Register here.</a> </p>
    </body>
    <script>
        document.getElementById("loginForm").addEventListener("submit", async (e) =>  {
            e.preventDefault();
            
            const username = document.getElementById("username").value;
            const password = document.getElementById("password").value;

            const response = await fetch("/login", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({username,password})
        });
        if (response.ok){ 
            window.location.href = '/';
        } else {
            const data = await response.json();
            alert(data.message || "Login failed");
        }
        const data = await response.json();
        console.log(data.message);
    });
    </script>

</html>